{"version":3,"sources":["Search.ts"],"names":[],"mappings":"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","file":"../Search.js","sourcesContent":["import { getParams } from \"./lib/query\";\r\nimport { PlayList } from \"./modules/PlayList\";\r\nimport { AudioPlayer } from \"./modules/AudioPlayer\";\r\nimport { Api } from \"./modules/Api\";\r\nimport { settings } from \"./settings\";\r\n\r\nclass Search {\r\n    user_info_dom: any;\r\n    songs_dom: any;\r\n    api: any;\r\n    player: any;\r\n    albums_content: any;\r\n    settings: any;\r\n    url_params: any;\r\n    search_string: string;\r\n    search_mode_select: any;\r\n    search_btn: any;\r\n    search_string_dom: any;\r\n    search_mode: string;\r\n    constructor(conf: any) {\r\n        this.user_info_dom = conf.user_info_dom;\r\n        this.songs_dom = conf.songs;\r\n\r\n        this.search_string_dom = search_string;\r\n        this.search_mode_select = search_mode_select;\r\n        this.search_btn = search_btn;\r\n\r\n        this.api = conf.api;\r\n        this.player = conf.player;\r\n        this.settings = conf.settings;\r\n        this.url_params = conf.url_params;\r\n        this.albums_content = conf.albums_content;\r\n        this.search_mode = \"name_song\";\r\n        this.search_string = \"\";\r\n    }\r\n    playMusic = (ev: any) => {\r\n        const song_data = JSON.parse(ev.target.getAttribute(\"data-info-music\"));\r\n        this.player.play(song_data);\r\n    };\r\n    createBackLink() {\r\n        return \"<a href='/'>Назад</a>\";\r\n    }\r\n    initPlaySongEvents() {\r\n        // вынести\r\n        const plays_btn: any = document.getElementsByClassName(\"play-btn\");\r\n        if (plays_btn) {\r\n            for (var i = 0; i < plays_btn.length; i++) {\r\n                plays_btn[i].addEventListener(\"click\", this.playMusic);\r\n            }\r\n        }\r\n    }\r\n    startSearch = () => {\r\n        const url_search =\r\n            `https://api.jamendo.com/v3.0/tracks/?client_id=${this.settings.client_id}&format=jsonpretty&limit=40&search=` +\r\n            this.search_string_dom.value.trim();\r\n        this.albums_content.innerHTML = \"<p>Поиск...</p>\";\r\n        this.api.getDataFromApi(url_search).then((data: any) => {\r\n            this.albums_content.innerHTML = \"\";\r\n            const playlist = new PlayList({\r\n                list: data.data,\r\n                title: \"Найденные композиции\",\r\n                type: \"track\",\r\n                url: url_search,\r\n            });\r\n            this.albums_content.insertAdjacentHTML(\"beforeend\", playlist.render());\r\n            const plays_btn: any = document.getElementsByClassName(\"play-btn\");\r\n            this.initListenMusicEvent(plays_btn);\r\n        });\r\n    };\r\n    initListenMusicEvent(plays_btn: any) {\r\n        if (plays_btn) {\r\n            for (var i = 0; i < plays_btn.length; i++) {\r\n                plays_btn[i].addEventListener(\"click\", this.playMusic);\r\n            }\r\n        }\r\n    }\r\n    initSearchEvents() {\r\n        this.search_btn.addEventListener(\"click\", this.startSearch);\r\n    }\r\n    async init() {\r\n        // вход\r\n        this.initSearchEvents();\r\n    }\r\n    async start() {\r\n        this.init();\r\n    }\r\n}\r\n\r\nconst user_info_dom = document.getElementById(\"user-info\");\r\nconst songs = document.getElementById(\"songs\");\r\nconst audio_player = document.getElementById(\"audio-player\");\r\nconst song_info_player = document.getElementById(\"song-info-player\");\r\n\r\nconst search_string = document.getElementById(\"search-string\");\r\nconst search_mode_select = document.getElementById(\"search-mode\");\r\nconst search_btn = document.getElementById(\"search-btn\");\r\nconst albums_content = document.getElementById(\"albums-content\");\r\n\r\nconst play_pause = document.getElementById(\"play-pause\");\r\nconst play_back = document.getElementById(\"play-back\");\r\nconst play_forward = document.getElementById(\"play-forward\");\r\nconst play_progress = document.getElementById(\"play-progress\");\r\nconst play_sound_mute = document.getElementById(\"play-sound-mute\");\r\nconst play_volume = document.getElementById(\"play-volume\");\r\nconst play_time_start = document.getElementById(\"play-time-start\");\r\nconst play_time_end = document.getElementById(\"play-time-end\");\r\nconst play_svg_path = document.getElementById(\"play_svg_path\");\r\nconst url_params = getParams(window.location);\r\n\r\nconst Api_object = new Api();\r\nconst player = new AudioPlayer({\r\n    audio_player: audio_player,\r\n    api: Api_object,\r\n    settings: settings,\r\n    song_info_player: song_info_player,\r\n    play_pause: play_pause,\r\n    play_back: play_back,\r\n    play_forward: play_forward,\r\n    play_progress: play_progress,\r\n    play_volume: play_volume,\r\n    play_sound_mute: play_sound_mute,\r\n    time_start: play_time_start,\r\n    time_end: play_time_end,\r\n    play_svg_path: play_svg_path,\r\n});\r\nconst main = new Search({\r\n    user_info_dom: user_info_dom,\r\n    songs: songs,\r\n    api: Api_object,\r\n    player: player,\r\n    settings: settings,\r\n    song_info_player: song_info_player,\r\n    url_params: url_params,\r\n    search_string: search_string,\r\n    search_mode_select: search_mode_select,\r\n    search_btn: search_btn,\r\n    albums_content: albums_content,\r\n});\r\nmain.init();\r\n"]}
{"version":3,"sources":["App — копия.ts"],"names":[],"mappings":"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","file":"../App — копия.js","sourcesContent":["import { postJSON, getParams, getJSON } from \"./lib/query\";\r\nimport { PlayList } from \"./modules/PlayList\";\r\nimport { AudioPlayer } from \"./modules/AudioPlayer\";\r\nimport { Api } from \"./modules/Api\";\r\nimport { settings } from \"./settings\";\r\n// const settings = {\r\n//     // _client_id: \"cf25482b\",\r\n//     _client_id: \"cf25482b\",\r\n//     _api_key: \"4797f3a80bd19061a2d6e4ffc7f89856b040a81a\",\r\n//     _secret: \"6b8f1bb64f106a4f520b3bf98717e06e\",\r\n//     _api_base: \"https://api.jamendo.com/v3.0/\",\r\n//     _code: \"4fc6741c3be9f6fb9c13c9be0e8c2f9889e98396\",\r\n// };\r\n// let access_token: any = null;\r\n\r\nlet access_token: any = {\r\n    access_token: \"29ee047172004fe40585a0005418b36af45a7583\",\r\n    expires_in: 14400,\r\n    refresh_token: \"3ace4beaf7f01bc0a1cab0d1f37b4d0bb67d455f\",\r\n    scope: \"music\",\r\n    token_type: \"bearer\",\r\n};\r\nfunction getPlaylist() {\r\n    return new Promise((resolve, reject) => {\r\n        const url =\r\n            \"https://api.jamendo.com/v3.0/playlists/?client_id=cf25482b&format=jsonpretty&access_token=\" +\r\n            access_token.access_token;\r\n        getJSON(url).then((data) => {\r\n            resolve(data);\r\n        });\r\n    });\r\n}\r\nasync function getCurentUserInfo() {\r\n    return new Promise((resolve, reject) => {\r\n        const url =\r\n            \"https://api.jamendo.com/v3.0/users/?client_id=cf25482b&format=jsonpretty&access_token=\" +\r\n            access_token.access_token;\r\n        getJSON(url).then((data: any) => {\r\n            if (data.headers.status === \"success\") {\r\n                resolve({ result: true, user: data.results[0] });\r\n            } else {\r\n                resolve({ result: false, message: data });\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction getDataFromApi(url: string) {\r\n    return new Promise((resolve, reject) => {\r\n        getJSON(url).then((data: any) => {\r\n            if (data.headers.status === \"success\") {\r\n                resolve({ result: true, data: data.results });\r\n            } else {\r\n                resolve({ result: false, message: data });\r\n            }\r\n        });\r\n    });\r\n}\r\nconst url_params = getParams(window.location);\r\nif (url_params.code && false) {\r\n    // https://pixel-space.herokuapp.com/?module=registration&action=Enter\r\n\r\n    postJSON(\"/\", {\r\n        code: url_params.code,\r\n    }).then((answer: any) => {\r\n        console.log(\"answeranswer\", answer);\r\n        access_token = JSON.parse(answer.access_token);\r\n        console.log(access_token);\r\n        if (access_token.error) {\r\n            console.log(\"ERROR =>\", access_token.error_description);\r\n        } else {\r\n        }\r\n    });\r\n}\r\nfunction getTemplateForUserInfo(user_info: any) {\r\n    return `\r\n        <div>\r\n            <img src=\"${user_info.image}\"alt=\"image_profile\">\r\n            <span>${user_info.dispname}</span>\r\n        </div>\r\n    `;\r\n}\r\nclass MainPage {\r\n    user_info_dom: any;\r\n    albums_content: any;\r\n    api: any;\r\n    player: any;\r\n    settings: any;\r\n    constructor(conf: any) {\r\n        this.user_info_dom = conf.user_info_dom;\r\n        this.albums_content = conf.albums_content;\r\n        this.api = conf.api;\r\n        this.player = conf.player;\r\n        this.settings = conf.settings;\r\n    }\r\n    playMusic = (ev: any) => {\r\n        ev.preventDefault();\r\n        console.log(\r\n            \"Play music\",\r\n            ev.target,\r\n            ev.target.getAttribute(\"data-info-music\"),\r\n            ev.target.getAttribute(\"data-info-music\")\r\n        );\r\n        const song_data = JSON.parse(ev.target.getAttribute(\"data-info-music\"));\r\n        this.player.play(song_data);\r\n    };\r\n    async init() {\r\n        // вход\r\n        console.log(\"init\");\r\n        const link = document.getElementById(\"registration__link\");\r\n        link?.setAttribute(\r\n            \"href\",\r\n            `https://api.jamendo.com/v3.0/oauth/authorize?client_id=${this.settings.client_id}&redirect_uri=http://localhost:4567/&response_type=code`\r\n        );\r\n        const user_info: any = await getCurentUserInfo();\r\n        if (this.user_info_dom && user_info.result) {\r\n            const user_info_content = getTemplateForUserInfo(user_info.user);\r\n            this.user_info_dom.insertAdjacentHTML(\"beforeend\", user_info_content);\r\n        } else {\r\n            console.log(\"user_info\", user_info);\r\n        }\r\n        console.log(\"this.albums_content\", this.albums_content);\r\n        if (this.albums_content) {\r\n            // fuzzytags - выбор по тегам\r\n            // const url = `https://api.jamendo.com/v3.0/albums/?client_id=${settings._client_id}&format=jsonpretty&limit=8&order=popularity_total\r\n            // &lang=en&hasscore=2&access_token=${access_token.access_token}`;\r\n            // const url_top = `https://api.jamendo.com/v3.0/tracks/?client_id=${this.settings.client_id}&format=jsonpretty&limit=12&include=musicinfo&boost=listens_week&imagesize=100`;\r\n            // const track_top: any = await getDataFromApi(url_top);\r\n            // // console.log(\"track_top\", track_top);\r\n            // let playlist = new PlayList(track_top.data, \"Новинки недели\");\r\n            // this.user_info_dom.insertAdjacentHTML(\"beforeend\", playlist.render());\r\n            // // новинки\r\n\r\n            const url = `https://api.jamendo.com/v3.0/playlists/?client_id=${this.settings.client_id}&format=jsonpretty&limit=12&datebetween=2022-01-02_2022-04-01&hasimage=1`;\r\n            const albums: any = await getDataFromApi(url);\r\n            // console.log(\"albums\", albums);\r\n            let playlist = new PlayList(albums.data, \"Плейлисты\", \"playlist\");\r\n            this.user_info_dom.insertAdjacentHTML(\"beforeend\", playlist.render());\r\n            // по жанрам\r\n            // const url_jenre = `https://api.jamendo.com/v3.0/playlists/?client_id=${this.settings.client_id}&format=jsonpretty&limit=12&hasimage=1`;\r\n            // const albums_jenre: any = await getDataFromApi(url_jenre);\r\n            // // console.log(\"albums_jenre 11111111\", albums_jenre);\r\n            // playlist = new PlayList(albums_jenre.data);\r\n            // this.user_info_dom.insertAdjacentHTML(\"beforeend\", playlist.render());\r\n            // // артисты\r\n            // const url_artist = `https://api.jamendo.com/v3.0/artists/?client_id=${this.settings.client_id}&format=jsonpretty&limit=12&imagesize=100`;\r\n            // const albums_artist: any = await getDataFromApi(url_artist);\r\n            // // console.log(\"albums_artist\", albums_artist)  ;\r\n            // playlist = new PlayList(albums_artist.data, \"Исполнители\");\r\n            // this.user_info_dom.insertAdjacentHTML(\"beforeend\", playlist.render());\r\n            // топ треков\r\n        }\r\n\r\n        const plays_btn: any = document.getElementsByClassName(\"play-btn\");\r\n        if (plays_btn) {\r\n            for (var i = 0; i < plays_btn.length; i++) {\r\n                plays_btn[i].addEventListener(\"click\", this.playMusic);\r\n            }\r\n        }\r\n    }\r\n    async start() {\r\n        this.init();\r\n    }\r\n}\r\n\r\nconst user_info_dom = document.getElementById(\"user-info\");\r\nconst albums_content = document.getElementById(\"albums-content\");\r\nconst audio_player = document.getElementById(\"audio-player\");\r\n\r\nconst Api_object = new Api();\r\nconst player = new AudioPlayer({ audio_player: audio_player, api: Api_object, settings: settings });\r\nconst main = new MainPage({\r\n    user_info_dom: user_info_dom,\r\n    albums_content: albums_content,\r\n    api: Api_object,\r\n    player: player,\r\n    settings: settings,\r\n});\r\nmain.start();\r\n"]}